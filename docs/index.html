<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>24 Game</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    text-align: center;
    background: linear-gradient(135deg, #4e73df, #1cc88a);
    color: white;
    padding-top: 40px;
}

h1 {
    font-size: 40px;
}

.game-container {
    margin-top: 30px;
}

.numbers button {
    font-size: 28px;
    margin: 10px;
    padding: 15px 20px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
}

.operators button {
    font-size: 22px;
    margin: 5px;
    padding: 10px 15px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
}

.controls button {
    margin: 10px;
    padding: 8px 15px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
}

.expression-box {
    margin-top: 20px;
    font-size: 24px;
    min-height: 40px;
}

.result {
    margin-top: 20px;
    font-size: 22px;
    font-weight: bold;
}

.hint {
    position: fixed;
    right: 30px;
    top: 30px;
    font-size: 30px;
    cursor: pointer;
}

.footer {
    position: fixed;
    bottom: 10px;
    left: 10px;
    font-size: 14px;
    opacity: 0.9;
}
</style>
</head>

<body>

<h1>24 Game</h1>

<div class="hint" onclick="showHint()">ðŸ”‘</div>

<div class="game-container">

<div class="numbers" id="numbers"></div>

<div class="operators">
    <button onclick="addOperator('+')">+</button>
    <button onclick="addOperator('-')">-</button>
    <button onclick="addOperator('*')">Ã—</button>
    <button onclick="addOperator('/')">Ã·</button>
    <button onclick="addOperator('(')">(</button>
    <button onclick="addOperator(')')">)</button>
</div>

<div class="expression-box" id="expression"></div>

<div class="controls">
    <button onclick="resetExpression()">Reset</button>
    <button onclick="newGame()">New Game</button>
</div>

<div class="result" id="result"></div>

</div>

<div class="footer">
Author: XIA RUI DONG | Contact: xiarui091@gmail.com
</div>

<script>
let numbers = [];
let usedCount = 0;
let expression = "";
let solution = "";

/* ---------- SOLVER ---------- */

function solve24(nums) {
    function dfs(arr, exprArr) {
        if (arr.length === 1) {
            if (Math.abs(arr[0] - 24) < 0.0001) {
                solution = exprArr[0];
                return true;
            }
            return false;
        }

        for (let i = 0; i < arr.length; i++) {
            for (let j = 0; j < arr.length; j++) {
                if (i === j) continue;

                let newArr = [];
                let newExpr = [];

                for (let k = 0; k < arr.length; k++) {
                    if (k !== i && k !== j) {
                        newArr.push(arr[k]);
                        newExpr.push(exprArr[k]);
                    }
                }

                let a = arr[i], b = arr[j];
                let expA = exprArr[i], expB = exprArr[j];

                let operations = [
                    { val: a + b, exp: `(${expA}+${expB})` },
                    { val: a - b, exp: `(${expA}-${expB})` },
                    { val: a * b, exp: `(${expA}*${expB})` }
                ];

                if (Math.abs(b) > 0.0001) {
                    operations.push({ val: a / b, exp: `(${expA}/${expB})` });
                }

                for (let op of operations) {
                    newArr.push(op.val);
                    newExpr.push(op.exp);

                    if (dfs(newArr, newExpr)) return true;

                    newArr.pop();
                    newExpr.pop();
                }
            }
        }
        return false;
    }

    return dfs(nums, nums.map(n => n.toString()));
}

/* ---------- GAME LOGIC ---------- */

function generateNumbers() {
    while (true) {
        numbers = [];
        for (let i = 0; i < 4; i++) {
            numbers.push(Math.floor(Math.random() * 13) + 1);
        }
        solution = "";
        if (solve24(numbers.slice())) break;
    }
}

function displayNumbers() {
    const container = document.getElementById("numbers");
    container.innerHTML = "";
    usedCount = 0;

    numbers.forEach((num) => {
        let btn = document.createElement("button");
        btn.innerText = num;
        btn.onclick = function () {
            expression += num;
            btn.disabled = true;
            btn.style.opacity = "0.5";
            usedCount++;
            updateExpression();
            checkAuto();
        };
        container.appendChild(btn);
    });
}

function addOperator(op) {
    expression += op;
    updateExpression();
}

function updateExpression() {
    document.getElementById("expression").innerText = expression;
}

function resetExpression() {
    expression = "";
    updateExpression();
    document.getElementById("result").innerText = "";
    displayNumbers();
}

function checkAuto() {
    if (usedCount === 4) {
        try {
            let value = eval(expression);

            if (Math.abs(value - 24) < 0.0001) {
                document.getElementById("result").innerText =
                    "âœ… Correct! You made 24!";
            } else {
                document.getElementById("result").innerText =
                    "âŒ Result: " + value.toFixed(2);
            }
        } catch {
            document.getElementById("result").innerText =
                "âš  Invalid Expression";
        }
    }
}

function showHint() {
    document.getElementById("result").innerText =
        "ðŸ’¡ Solution: " + solution;
}

function newGame() {
    expression = "";
    document.getElementById("result").innerText = "";
    generateNumbers();
    displayNumbers();
    updateExpression();
}

newGame();
</script>

</body>
</html>
